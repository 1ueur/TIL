웜과 바이러스의 종류는 매우 다양하고 보안 프로그램으로 삭제가 불가능한 악성 코드도 있어 이런 악성 코드는 수정으로 삭제해야 합니다.

## 네트워크 상태 점검
상당수의 악성 코드는 외부에 있는 해커나 악성 코드 작성자와 통신하기 위해 서비스 포트를 생성합니다.
1234, 8787, 666과 같이 번호 자체가 특이한 포트는 의심할 수 있지만 그렇지 않은 포트도 많아 포트 번호만으로는 악성 코드가 사용하는 포트인지 구별하기 힘듭니다.

시스템에서는 ```netstat``` 명령으로 열려 있는 포트를 확인할 수 있습니다.
최근에는 번호만으로 악성 코드를 추측하기 어렵습니다. 악성 코드가 사용하는 포트를 netstat 명령만으로 확인하기 어려운 경우에는 CPorts와 같은 프로그램으로 서비스 포트별로 사용하는 응용 프로그램을 확인할 수 있습니다.
그러면 의심스러운 포트를 포트 번호로 확인하는 것보다 확실하게 식별할 수 있습니다.

## 정상적인 프로세스와 비교
대부분의 악성 코드는 자신이 악성 코드라고 잘보이게 이름을 붙이지 않으므로 윈도우와 유닉스 시스템 등의 정상적인 프로세스를 외워두면 비정상적인 프로세스를 식별하는 데 많은 도움이 됩니다.
현재 동작 중인 정상적인 프로세스를 아는 것이 중요한데 윈도우에서는 ```Ctrl+Alt+Delete```로 작업 관리자를 실행해 현재 실행되는 프로세스를 확인할 수 있습니다. 또한 중간 과정 없이 ```Ctrl+Shift+Esc```를 누르면 작업 관리자를 통해 프로세스를 바로 확인할 수 있습니다.
맥은 ```기타-활성 상태 보기```에서 확인할 수 있습니다.

프로세스 확인 작업은 프로그램 실행 중에 빈번하게 사용됩니다. 특히 프로그램에 이상이 생기거나 의도치 않은 프로그램이 백그라운드에서 실행되고 있을 때는 항상 작업 관리자를 통해 확인해줍니다.
악성 코드가 주요 사용하는 서비스명은 ```csrss```와 ```svchost```입니다.

윈도우 작업 관리자에서 제공하는 프로세스 정보보다 좀 더 자세한 프로세스 정보를 알고 싶을 때는 Process Explorer를 사용합니다. 여기서는 프로세스별 부모와 자식 관계, 프로세스에 대한 간략한 설명, 프로그램을 만든 회사, 실행 과정에서 사용된 함수(DLL), 실행 파일 경로 등 매우 다양한 정보를 얻을 수 있습니다.

## 악성 코드의 실제 파일 확인
네트워크 상태와 프로세스 분석을 통해 파악한 악성 코드의 실제 파일을 확인할 수 있습니다. 윈도우 탐색기는 윈도우 운영체제와 많은 라이브러리를 공유하고 있어 윈도우 탐색기 자체가 악성 코드의 공격 대상이 되기도 합니다.
따라서 악성 코드 파일을 확인할 때에는 윈도우와 상관없이 독립적으로 동작하는 파일 탐색기인 total commander와 같은 툴을 이용합니다.
윈도우 탐색기가 이미 악성 코드의 공격을 받았다면 특정 파일이 숨겨져 보이지 않거나 삭제되지 않는 경우도 있습니다.

## 시작 프로그램과 레지스트리 확인
윈도우 시스템은 시작 프로그램 등 시스템 운영과 관련된 프로그램의 기본 설정 값이 재부팅 시에도 변하지 않도록 레지스트리에 여러 가지 값을 기록해둡니다.
악성 코드 역시 이러한 레지스터를 이용하는 경우가 많기 때문에 악성 코드를 삭제할 때는 레지스터에서도 관련 내용을 확인해야 합니다.
시작 프로그램 목록은 ```msconfig``` 명령을 통해 쉽게 확인할 수 있습니다.

## 악성 코드 제거
악성 코드의 포트, 서비스 목록, 파일, 레지스트리까지 확인했다면 윈도우 악성 코드의 실체는 대부분 파악했다고 볼 수 잇습니다.

```확인한 악성 코드를 삭제하는 절차```

**1. 악성 코드 프로세스 중지하기.** ```Kill Process Tree(Shift+Delete)```로 중지합니다.

**2. 악성 코드 파일 삭제하기.** 폴더에서 확인한 파일을 삭제합니다.

**3. 레지스트리 삭제하기.** 시작 프로그램에서 확인한 사항을 삭제합니다. ```regedit```으로 리지스트리 경로를 확인한 후 레지스트리에서 해당 항목을 삭제합니다.

